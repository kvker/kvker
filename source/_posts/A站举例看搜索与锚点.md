---
layout: note
title: A站举例看搜索与锚点
excerpt: Read more...
date: 2022-5-29 14:17:11
updated: 2022-5-29 14:17:11
comments: false
lang: zh-CN
---

<style>
img {
  max-width: 100%;
}
</style>

网站链接包含协议、域名、端口与路径。
拿A站来说：https://www.acfun.cn/，就是https:// + www.acfun.cn + :443 + /，由于浏览器知道https对应:443端口，也默认访问了根路径，所以:443/就被视觉省略了。

---

那拿A站的搜索来看，比如我们搜索“lol”，跳出的页面是这样：
链接地址是这样：https://www.acfun.cn/search?#query=lol;cid=0;sort=1;sid=0;page=1

这里注意?与#。

来一个标准化链接地址体会下：

https://domain:port/path/?search#anchor，翻译中文：协议+域名+端口+路径+搜索+锚点。

其中，搜索的格式是：?query0=value0&query1=value1&key2=value2……

锚点的格式可以理解为任意（合法即规则）。

而，整个链接的长度由于浏览器和服务器限制，我们依据最小原则，大概不大于500个字母与符号或250个汉字长度即可。

---

### 搜索

到这里，有小伙伴可能看到，这个A站的搜索链接并不规范啊，?后面直接跟了#，而#后面有点像搜索的格式，不过是把&换成了;而已。

这个前面说了，#后面几乎是任意的，所以只要支持逻辑展开处理，也可以把搜索（或其他）的内容丢到#后面，然后脚本处理。A站之所以这么干，主要因为这个页面是个单页面应用，估计是受前端框架影响导致，这不是坏事，对于用户来说，是好事。

如果硬要标准化输出，A站的搜索lol链接应该是这样：https://www.acfun.cn/search?query=lol&cid=0&sort=1&sid=0&page=1，不过这样在A站是行不通的，我们知道就行。

---

然后分析搜索的东西规则。

把上面链接的搜索平铺开：

关键词|值
-|-:
query|lol
cid|分类
sort|排序
sid|盲猜用户类型
page|页码

cid与sort就是这个：


page是底部这个：


---

### 锚点

锚点的作用是页内跳转，就好比你打开word文档，点击目录就会跳到某个目录页一样，前提一样，这个锚点（目录）存在，如果不存在，就无效，但不报错，这很重要。
因为锚点是页内跳转又不报错还可以随便写内容的特性，所以当下越来越多的网站采用单页面内部操作模式，提升用户交互。因为没有刷新页面的白屏等待了。所以，这里A站的工程师把搜索内容放到锚点上，也没什么问题。

锚点的功能相对简单，当然也可以很复杂，比如A站这种把锚点当搜索用的情况。

---

我们分析了上述的内容后，可以得到A站的搜索规律，拿着这个规律，我们就可以玩一些好玩的了。

########选学分割线########

右键搜索页面空白处，点击检查（IE的小伙伴可以跳过选学内容了）。

然后点击Network栏，下方有个XHR，点击高亮后，我们换个搜索内容，比如“卧槽”。

得到这样的页面，并找到这个东西：


即：https://www.acfun.cn/rest/pc-direct/search/video?keyword=%E5%8D%A7%E6%A7%BD&pCursor=1&channelId=0&sortType=1&requestId=

这里的keyword=%E5%8D%A7%E6%A7%BD相当于keyword=卧槽，之所以变成%XX是传输转码，你知道是一个东西就行。

然后把这一段拷贝到另一个网页地址栏回车，你会看到这样的页面：


这里的两个title区别，一个纯title就是文本，另一个emTitle是富文本，可以直接用来上色之类的，比如标红啊，都很方便。

你会发现这里一共20条，注意title可以一一对应到搜索页面的结果。有点互联网基础的小伙伴已经发现，这个就是那些视频列表的数据了。

然后，假如你有一个自己的网站，然后你又有这些数据，啧啧啧……（前提合法啊）

举个简单栗子，比如注入都你自己的网站上：


进阶玩法（多了用户认证环节，不考虑爆破的话，原理是一样的），搞淘宝试用，然后进行概率排序：


（这里的认证信息自行从try.taobao.com获取（必须登录）：

